<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Informe Práctica 10</title><meta name="description" content="Documentation for Informe Práctica 10"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">Informe Práctica 10</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1> Informe Práctica 10 </h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#práctica-10---sistema-de-ficheros-y-creación-de-procesos-en-nodejs" id="práctica-10---sistema-de-ficheros-y-creación-de-procesos-en-nodejs" style="color: inherit; text-decoration: none;">
  <h1><strong>Práctica 10 - Sistema de ficheros y creación de procesos en Node.js</strong></h1>
</a>

<a href="#marc-carbonell-gonzález-de-chaves" id="marc-carbonell-gonzález-de-chaves" style="color: inherit; text-decoration: none;">
  <h2>Marc Carbonell González de Chaves</h2>
</a>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101323282/actions/workflows/tests.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101323282/actions/workflows/tests.yml/badge.svg" alt="Tests"></a>
<a href="https://coveralls.io/github/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101323282?branch=main"><img src="https://coveralls.io/repos/github/ULL-ESIT-INF-DSI-2122/ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101323282/badge.svg?branch=main" alt="Coverage Status"></a>
<a href="https://sonarcloud.io/summary/new_code?id=ULL-ESIT-INF-DSI-2122_ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101323282"><img src="https://sonarcloud.io/api/project_badges/measure?project=ULL-ESIT-INF-DSI-2122_ull-esit-inf-dsi-21-22-prct10-async-fs-process-alu0101323282&metric=alert_status" alt="Quality Gate Status"></a></p>

<a href="#tareas-previas" id="tareas-previas" style="color: inherit; text-decoration: none;">
  <h2><strong>Tareas previas</strong></h2>
</a>
<ul>
<li>Acepté la <a href="https://classroom.github.com/a/HGuJ39-8">asignación de GitHub Classroom</a> asociada a esta práctica.</li>
<li>Me familiaricé con el <a href="https://nodejs.org/dist/latest-v18.x/docs/api/fs.html#callback-api">API de callbacks proporcionada por Node.js para interactuar con el sistema de ficheros</a>.</li>
<li>Me familiaricé con el <a href="https://nodejs.org/dist/latest-v18.x/docs/api/child_process.html#asynchronous-process-creation">API asíncrona proporcionada por Node.js para crear procesos</a> y, en concreto, con la función <code>spawn</code>.</li>
</ul>

<a href="#ejercicios" id="ejercicios" style="color: inherit; text-decoration: none;">
  <h2><strong>Ejercicios</strong></h2>
</a>

<a href="#ejercicio-1" id="ejercicio-1" style="color: inherit; text-decoration: none;">
  <h3><strong>Ejercicio 1</strong></h3>
</a>
<p>Traza de ejecución del siguiente código:</p>
<pre><code class="language-typescript"><span class="hl-0">import</span><span class="hl-1"> {</span><span class="hl-2">access</span><span class="hl-1">, </span><span class="hl-2">constants</span><span class="hl-1">, </span><span class="hl-2">watch</span><span class="hl-1">} </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&#39;fs&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1"> !== </span><span class="hl-4">3</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Please, specify a file&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">} </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">filename</span><span class="hl-1"> = </span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">];</span><br/><br/><span class="hl-1">  </span><span class="hl-5">access</span><span class="hl-1">(</span><span class="hl-2">filename</span><span class="hl-1">, </span><span class="hl-2">constants</span><span class="hl-1">.</span><span class="hl-7">F_OK</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> does not exist`</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Starting to watch file </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">);</span><br/><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">watcher</span><span class="hl-1"> = </span><span class="hl-5">watch</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">argv</span><span class="hl-1">[</span><span class="hl-4">2</span><span class="hl-1">]);</span><br/><br/><span class="hl-1">      </span><span class="hl-2">watcher</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been modified somehow`</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`File </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> is no longer watched`</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">}</span>
</code></pre>
<ul>
<li><p>Pila de llamadas:</p>
<p>  <code>if (process.argv.length !== 3)</code></p>
</li>
<li><p>Registro de eventos:</p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola:</p>
<p>  ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
<p>  <code>const filename = process.argv[2];</code></p>
</li>
<li><p>Registro de eventos:</p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola:</p>
<p>  ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
<p>  <code>if (err)</code></p>
<p>  <code>access(filename, constants.F_OK, (err) =&gt; {..}</code></p>
</li>
<li><p>Registro de eventos:</p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola:</p>
<p>  ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
<p>  <code>console.log(&#39;Starting to watch file ${filename}&#39;);</code></p>
<p>  <code>access(filename, constants.F_OK, (err) =&gt; {..}</code></p>
</li>
<li><p>Registro de eventos:</p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola:</p>
<p>  ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
<p>  <code>const watcher = watch(process.argv[2]);</code> </p>
<p>  <code>access(filename, constants.F_OK, (err) =&gt; {..}</code></p>
</li>
<li><p>Registro de eventos:</p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola: <code>Starting to watch file helloworld.txt</code></p>
<p>  ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
<p>  <code>watcher.on(&#39;change&#39;, () =&gt; {..}</code> </p>
<p>  <code>access(filename, constants.F_OK, (err) =&gt; {..}</code></p>
</li>
<li><p>Registro de eventos:</p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola:</p>
<p>  ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
<p>  <code>console.log(&#39;File ${filename} is no longer watched&#39;);</code></p>
<p>  <code>access(filename, constants.F_OK, (err) =&gt; {..}</code>     </p>
</li>
<li><p>Registro de eventos:</p>
<p>  <code>on(&#39;change&#39;, () =&gt; {console.log(&#39;File ${filename} has been modified somehow&#39;);});</code></p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola:</p>
<p>  ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
</li>
<li><p>Registro de eventos:</p>
<p>  <code>on(&#39;change&#39;, () =&gt; {console.log(&#39;File ${filename} has been modified somehow&#39;);});</code></p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola: <code>File helloworld.txt is no longer watched</code></p>
<p>  ⬇️</p>
</li>
</ul>
<p> (En este momento se realiza una modificación en el fichero helloworld.txt)</p>
<ul>
<li><p>Pila de llamadas:</p>
</li>
<li><p>Registro de eventos:</p>
<p>  <code>on(&#39;change&#39;, () =&gt; {console.log(File ${filename} has been modified somehow&#39;);});</code></p>
</li>
<li><p>Cola de manejadores:</p>
<p>  <code>() =&gt; {console.log(&#39;File ${filename} has been modified somehow&#39;);</code></p>
</li>
<li><p>Consola:</p>
<p>  ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
<p>  <code>console.log(&#39;File ${filename} has been modified somehow&#39;);</code></p>
</li>
<li><p>Registro de eventos:</p>
<p>  <code>on(&#39;change&#39;, () =&gt; {console.log(&#39;File ${filename} has been modified somehow&#39;);});</code></p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola:</p>
<p>  ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
</li>
<li><p>Registro de eventos:</p>
<p>  <code>on(&#39;change&#39;, () =&gt; {console.log(&#39;File ${filename} has been modified somehow&#39;);});</code></p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola: <code>File helloworld.txt has been modified somehow</code></p>
<p>  ⬇️</p>
</li>
</ul>
<p> (En este momento se realiza otra modificación en el fichero helloworld.txt)</p>
<ul>
<li><p>Pila de llamadas:</p>
</li>
<li><p>Registro de eventos:</p>
<p>  <code>on(&#39;change&#39;, () =&gt; {console.log(&#39;File ${filename} has been modified somehow&#39;);});</code></p>
</li>
<li><p>Cola de manejadores:</p>
<p>  <code>() =&gt; {console.log(&#39;File ${filename} has been modified somehow&#39;);</code></p>
</li>
<li><p>Consola:</p>
<p> ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
<p>  <code>console.log(&#39;File ${filename} has been modified somehow&#39;);</code></p>
</li>
<li><p>Registro de eventos:</p>
<p>  <code>on(&#39;change&#39;, () =&gt; {console.log(&#39;File ${filename} has been modified somehow&#39;);});</code></p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola:</p>
<p>  ⬇️</p>
</li>
<li><p>Pila de llamadas:</p>
</li>
<li><p>Registro de eventos:</p>
<p>  <code>on(&#39;change&#39;, () =&gt; {console.log(&#39;File ${filename} has been modified somehow&#39;);});</code></p>
</li>
<li><p>Cola de manejadores:</p>
</li>
<li><p>Consola: <code>File helloworld.txt has been modified somehow</code></p>
</li>
</ul>
<p>Cabe destacar que en esta traza no se ha tenido en cuenta que la función asíncrona <code>fs.watch</code> suele emitir los eventos de 2 en 2, ya que este no es un comportamiento habitual en el resto de funciones de este tipo.</p>
<p>¿Qué hace la función access?</p>
<p>La función <code>acces</code> es una función asíncrona que comprueba los permisos de un archivo o directorio determinado.</p>
<p>¿Para qué sirve el objeto constants?</p>
<p>El objeto <code>constants</code> es un valor entero que indica el permiso que se va a comprobar. En el caso del código anterior, <code>constants.F_OK</code> indica si el archivo es visible para el proceso principal, esto es útil para determinar si un archivo existe, que es, precisamente, para lo que se utiliza en este caso.</p>

<a href="#ejercicio-2" id="ejercicio-2" style="color: inherit; text-decoration: none;">
  <h3><strong>Ejercicio 2</strong></h3>
</a>
<p>Para este ejercicio cree la clase <code>WordFinder</code> que hereda de <code>EventEmitter</code> y que contine dos métodos para buscar palabras en un archivo de texto, uno haciendo uso del método <code>pipe</code> de un Stream para poder redirigir la salida del comando <code>cat</code> hacia el comando <code>grep</code>, y el otro sin hacer uso del método pipe, solamente creando los subprocesos necesarios y registrando manejadores a aquellos eventos necesarios. La palabra y el archivo en el que buscar serán pasados como parámetros desde la línea de comandos haciendo uso del paquete yargs.</p>
<ul>
<li><p>pipesFind(): Este método utiliza la función asíncrona <code>spawn</code> para crear los dos subprocesos <code>cat</code> y <code>grep</code> y redirige la salida del primero hacia el segundo con <code>pipe</code>. Tras esto se registra un manejador que se activará al recibir datos desde la salida del comando <code>grep</code> (grep.stdout.on(&#39;data&#39;)), dichos datos contendrán una cadena de carácteres con las líneas en las que se ha encontrado la palabra a buscar. Una vez obtenidas la líneas en las que se encuentra la palabra buscada, se cuentan el número de ocurrencias de dicha palabra mediante un bucle <code>while</code> y el método <code>indexOf()</code> de string, y se imprime un mensaje informativo por pantalla.</p>
<p>Para detectar los casos en los que no se encuentra la palabra a buscar, se utiliza un booleano <code>found</code> que por defecto tendrá el valor <code>false</code> y que se marcará como <code>true</code> en caso de encontrar la palabra en cuestión. De esta forma, se registra un manejador que se activará cuando se cierre el subproceso <code>grep</code> (grep.on(<code>close</code>)) y que en caso de que <code>found</code> sea <code>false</code> mostrará un mensaje por pantalla informando de que la palabra no ha sido encontrada.</p>
</li>
<li><p>find(): Este método funciona igual que el anterior, pero para redirigir la salida de un comando hacia el otro, se crea el subproceso <code>cat</code> con la función asíncrona <code>spawn</code> para después, mediante un manejador que se activa al recibir datos desde la salida de dicho proceso (cat.stdout.on(&#39;data&#39;)), pasar dichos datos recibidos como parámetro al comando <code>grep</code> en la creación de dicho subproceso.</p>
</li>
</ul>
<pre><code class="language-typescript"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">WordFinder</span><span class="hl-1"> </span><span class="hl-6">extends</span><span class="hl-1"> </span><span class="hl-8">EventEmitter</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-6">super</span><span class="hl-1">();</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-5">pipesFind</span><span class="hl-1">(</span><span class="hl-2">fileName</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-2">word</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">): </span><span class="hl-8">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">cat</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;cat&#39;</span><span class="hl-1">, [</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">fileName</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">]);</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">grep</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;grep&#39;</span><span class="hl-1">, [</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">word</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">]);</span><br/><span class="hl-1">    </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">found</span><span class="hl-1">: </span><span class="hl-8">boolean</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-2">cat</span><span class="hl-1">.</span><span class="hl-2">stderr</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Error finding the word`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;catError&#39;</span><span class="hl-1">, </span><span class="hl-2">err</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-2">cat</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">pipe</span><span class="hl-1">(</span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-2">stdin</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">piece</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">count</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-4">0</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">i</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-4">0</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-0">while</span><span class="hl-1"> (</span><span class="hl-2">piece</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">().</span><span class="hl-5">indexOf</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">word</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">, </span><span class="hl-2">i</span><span class="hl-1">) !== -</span><span class="hl-4">1</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">count</span><span class="hl-1"> ++;</span><br/><span class="hl-1">        </span><span class="hl-2">i</span><span class="hl-1"> = </span><span class="hl-2">piece</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">().</span><span class="hl-5">indexOf</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">word</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">, </span><span class="hl-2">i</span><span class="hl-1">) + </span><span class="hl-4">1</span><span class="hl-1">;</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Word found </span><span class="hl-6">${</span><span class="hl-2">count</span><span class="hl-6">}</span><span class="hl-3"> time/s`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;pipes&#39;</span><span class="hl-1">, </span><span class="hl-3">`Word found </span><span class="hl-6">${</span><span class="hl-2">count</span><span class="hl-6">}</span><span class="hl-3"> time/s`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-2">found</span><span class="hl-1"> = </span><span class="hl-6">true</span><span class="hl-1">;</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;close&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-2">found</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Word not found&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;word&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Word not found&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-5">find</span><span class="hl-1">(</span><span class="hl-2">fileName</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-2">word</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">): </span><span class="hl-8">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">cat</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;cat&#39;</span><span class="hl-1">, [</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">fileName</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">]);</span><br/><span class="hl-1">    </span><span class="hl-2">cat</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">datos</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">grep</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">`grep &#39;</span><span class="hl-6">${</span><span class="hl-2">word</span><span class="hl-6">}</span><span class="hl-3">&#39; &lt;&lt;&lt; &#39;</span><span class="hl-6">${</span><span class="hl-2">datos</span><span class="hl-6">}</span><span class="hl-3">&#39;`</span><span class="hl-1">, {</span><br/><span class="hl-1">        </span><span class="hl-2">shell:</span><span class="hl-1"> </span><span class="hl-3">&#39;/bin/bash&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">found</span><span class="hl-1">: </span><span class="hl-8">boolean</span><span class="hl-1"> = </span><span class="hl-6">false</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">piece</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">count</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-4">0</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-6">let</span><span class="hl-1"> </span><span class="hl-2">i</span><span class="hl-1">: </span><span class="hl-8">number</span><span class="hl-1"> = </span><span class="hl-4">0</span><span class="hl-1">;</span><br/><span class="hl-1">        </span><span class="hl-0">while</span><span class="hl-1"> (</span><span class="hl-2">piece</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">().</span><span class="hl-5">indexOf</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">word</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">, </span><span class="hl-2">i</span><span class="hl-1">) !== -</span><span class="hl-4">1</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">count</span><span class="hl-1"> ++;</span><br/><span class="hl-1">          </span><span class="hl-2">i</span><span class="hl-1"> = </span><span class="hl-2">piece</span><span class="hl-1">.</span><span class="hl-5">toString</span><span class="hl-1">().</span><span class="hl-5">indexOf</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">word</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">, </span><span class="hl-2">i</span><span class="hl-1">) + </span><span class="hl-4">1</span><span class="hl-1">;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Word found </span><span class="hl-6">${</span><span class="hl-2">count</span><span class="hl-6">}</span><span class="hl-3"> time/s`</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;noPipes&#39;</span><span class="hl-1">, </span><span class="hl-3">`Word found </span><span class="hl-6">${</span><span class="hl-2">count</span><span class="hl-6">}</span><span class="hl-3"> time/s`</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-2">found</span><span class="hl-1"> = </span><span class="hl-6">true</span><span class="hl-1">;</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-2">grep</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;close&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-2">found</span><span class="hl-1">) {</span><br/><span class="hl-1">          </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Word not found&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;noWord&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Word not found&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-2">cat</span><span class="hl-1">.</span><span class="hl-2">stderr</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Error finding the word`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;error&#39;</span><span class="hl-1">, </span><span class="hl-2">err</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#ejercicio-3" id="ejercicio-3" style="color: inherit; text-decoration: none;">
  <h3><strong>Ejercicio 3</strong></h3>
</a>
<p>Para este ejercicio cree la clase <code>DirectoryWatcher</code> que hereda de <code>EventEmitter</code> y que contine el método <code>watchDirectory</code> que observa los cambios producidos en un directorio. El usuario y el directorio a observar serán pasados como parámetros desde la línea de comandos haciendo uso del paquete yargs.</p>
<ul>
<li>watchDirectory(): Este método utiliza la función asíncrona <code>watch</code> para observar los cambios realizados en el directorio a observar y registra manejadores que en caso de creación/modificación (watcher.on(&#39;change&#39;)) o de eliminación (watcher.on(&#39;rename&#39;)) muestran por pantalla un mensaje informativo.</li>
</ul>
<p>¿Cómo haría para mostrar, no solo el nombre, sino también el contenido del fichero, en el caso de que haya sido creado o modificado?</p>
<p>Dentro del manejador del evento <code>change</code>, que es el que indica que un archivo ha sido creado o modificado, utilizaría la función asíncrona <code>readFile</code> para mostrar el contenido del archivo en cuestión.</p>
<p>¿Cómo haría para que no solo se observase el directorio de un único usuario sino todos los directorios correspondientes a los diferentes usuarios de la aplicación de notas?</p>
<p>Utilizaría la función <code>watch</code> con la opción <code>recursive</code> activada para observar los cambios en el directorio general que contiene todos los directorios de los usuarios.</p>
<pre><code class="language-typescript"><span class="hl-5">watch</span><span class="hl-1">(</span><span class="hl-3">&#39;/NoteAppDirectories&#39;</span><span class="hl-1">, {</span><span class="hl-2">recursive:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1">});</span>
</code></pre>
<pre><code class="language-typescript"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">DirectoryWatcher</span><span class="hl-1"> </span><span class="hl-6">extends</span><span class="hl-1"> </span><span class="hl-8">EventEmitter</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-6">super</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-5">watchDirectory</span><span class="hl-1">(</span><span class="hl-2">user</span><span class="hl-1">: </span><span class="hl-2">string</span><span class="hl-1">, </span><span class="hl-2">directory</span><span class="hl-1">: </span><span class="hl-2">string</span><span class="hl-1">): </span><span class="hl-2">FSWatcher</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`Watching </span><span class="hl-6">${</span><span class="hl-2">user</span><span class="hl-6">}</span><span class="hl-3"> notes`</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">watcher</span><span class="hl-1"> = </span><span class="hl-5">watch</span><span class="hl-1">(</span><span class="hl-2">directory</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-2">watcher</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;rename&#39;</span><span class="hl-1">, (</span><span class="hl-2">filename</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`The note </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been removed`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;rename&#39;</span><span class="hl-1">, </span><span class="hl-3">`The note </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been removed`</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-2">watcher</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">, (</span><span class="hl-2">filename</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">`The note </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been created/modified`</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;change&#39;</span><span class="hl-1">, </span><span class="hl-3">`The note </span><span class="hl-6">${</span><span class="hl-2">filename</span><span class="hl-6">}</span><span class="hl-3"> has been created/modified`</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-2">watcher</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;error&#39;</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Error watching the directory&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;error&#39;</span><span class="hl-1">, </span><span class="hl-2">err</span><span class="hl-1">.</span><span class="hl-2">message</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">watcher</span><span class="hl-1">;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#ejercicio-4" id="ejercicio-4" style="color: inherit; text-decoration: none;">
  <h3><strong>Ejercicio 4</strong></h3>
</a>
<p>Para este ejercicio cree la clase <code>Wrapper</code> que hereda de <code>EventEmitter</code> y que contine métodos que realizan la función propia de algunos comandos de Linux. El comando a utilizar, asi como sus opciones, serán pasados como parámetros desde la línea de comandos haciendo uso del paquete yargs.</p>
<ul>
<li>directoryOrFile(): Este método indica si un fichero es un archivo o un directorio, para ello utiliza <code>spawn</code> para crear dos subprocesos con comandos que solo devolverán datos si el archivo en cuestión es un directorio, en el caso de <code>directory</code>, o un archivo, en caso de <code>file</code>. De esta forma, registrando manejadores con el evento &#39;data&#39; para cada subproceso, podemos comprobar si el fichero en cuestión es un directorio o un archivo.</li>
<li>createDirectory(): Este método simplemente utiliza la función asíncrona <code>mkdir</code> para crear un directorio en la ruta indicada.</li>
<li>listFiles(): Este método utiliza <code>spawn</code> para crear un subproceso con el comando <code>ls</code> y el directorio objetivo ccomo parámetro. De esta forma, registrando un manejador con el evento &#39;data&#39; para dicho subproceso, podemos mostrar por pantalla los ficheros que contiene dicho directorio.</li>
<li>showContent(): Este método utiliza de nuevo <code>spawn</code> para crear un subproceso, en este caso con el comando <code>cat</code> y el archivo objetivo como parámetro. De esta forma, registrando un manejador con el evento &#39;data&#39; para dicho subproceso, podemos mostrar por pantalla el contenido de dicho archivo.</li>
<li>remove(): Este método utiliza la función asíncrona <code>rm</code> para eliminar el fichero indicado.</li>
<li>rename(): Este método utiliza la función asíncrona <code>rename</code> para mover un archivo cambiando su ruta.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-0">export</span><span class="hl-1"> </span><span class="hl-6">class</span><span class="hl-1"> </span><span class="hl-8">Wrapper</span><span class="hl-1"> </span><span class="hl-6">extends</span><span class="hl-1"> </span><span class="hl-8">EventEmitter</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-6">super</span><span class="hl-1">();</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-5">directoryOrFile</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">): </span><span class="hl-8">void</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-5">existsSync</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">)) {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;File or directory not found&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;notFound&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;File or directory not found&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">directory</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">`test -d </span><span class="hl-6">${</span><span class="hl-2">path</span><span class="hl-6">}</span><span class="hl-3"> &amp;&amp; echo &quot;Found/Exists&quot;`</span><span class="hl-1">, {</span><br/><span class="hl-1">        </span><span class="hl-2">shell:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1">,</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">file</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">`test -f </span><span class="hl-6">${</span><span class="hl-2">path</span><span class="hl-6">}</span><span class="hl-3"> &amp;&amp; echo &quot;Found/Exists&quot;`</span><span class="hl-1">, {</span><br/><span class="hl-1">        </span><span class="hl-2">shell:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1">,</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-2">directory</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Is a directory&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;directory&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Is a directory&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">      </span><span class="hl-2">file</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Is a file&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;file&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Is a file&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      });</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-5">createDirectory</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">mkdir</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">path</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Error creating the directory&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;mkdirError&#39;</span><span class="hl-1">, </span><span class="hl-2">err</span><span class="hl-1">.</span><span class="hl-2">message</span><span class="hl-1">);</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Directory created&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;mkdir&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Directory created&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-5">listFiles</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">ls</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;ls&#39;</span><span class="hl-1">, [</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">path</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">]);</span><br/><span class="hl-1">    </span><span class="hl-2">ls</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">ls</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">pipe</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;ls&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Files listed&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-2">ls</span><span class="hl-1">.</span><span class="hl-2">stderr</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Error listing files&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;lsError&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Error listing files&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-5">showContent</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">const</span><span class="hl-1"> </span><span class="hl-7">cat</span><span class="hl-1"> = </span><span class="hl-5">spawn</span><span class="hl-1">(</span><span class="hl-3">&#39;cat&#39;</span><span class="hl-1">, [</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">path</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">]);</span><br/><span class="hl-1">    </span><span class="hl-2">cat</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">cat</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">.</span><span class="hl-5">pipe</span><span class="hl-1">(</span><span class="hl-2">process</span><span class="hl-1">.</span><span class="hl-2">stdout</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;cat&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Content showed&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-2">cat</span><span class="hl-1">.</span><span class="hl-2">stderr</span><span class="hl-1">.</span><span class="hl-5">on</span><span class="hl-1">(</span><span class="hl-3">&#39;data&#39;</span><span class="hl-1">, () </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Error show file</span><span class="hl-9">\&#39;</span><span class="hl-3">s content&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;showError&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;Error show file</span><span class="hl-9">\&#39;</span><span class="hl-3">s content&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-5">remove</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">rm</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-6">${</span><span class="hl-2">path</span><span class="hl-6">}</span><span class="hl-3">`</span><span class="hl-1">, {</span><span class="hl-2">recursive:</span><span class="hl-1"> </span><span class="hl-6">true</span><span class="hl-1">}, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Error removing the file&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;rmError&#39;</span><span class="hl-1">, </span><span class="hl-2">err</span><span class="hl-1">.</span><span class="hl-2">message</span><span class="hl-1">);</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;File removed&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;rm&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;File removed&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-5">move</span><span class="hl-1">(</span><span class="hl-2">src</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">, </span><span class="hl-2">dst</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">rename</span><span class="hl-1">(</span><span class="hl-2">src</span><span class="hl-1">, </span><span class="hl-2">dst</span><span class="hl-1">, (</span><span class="hl-2">err</span><span class="hl-1">) </span><span class="hl-6">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">err</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;Error moving the file&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;moveError&#39;</span><span class="hl-1">, </span><span class="hl-2">err</span><span class="hl-1">.</span><span class="hl-2">message</span><span class="hl-1">);</span><br/><span class="hl-1">      } </span><span class="hl-0">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-5">log</span><span class="hl-1">(</span><span class="hl-3">&#39;File moved&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-6">this</span><span class="hl-1">.</span><span class="hl-5">emit</span><span class="hl-1">(</span><span class="hl-3">&#39;move&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;File moved&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Modules</a></li><li class=" tsd-kind-module"><a href="modules/EjercicioPE102_Cut.html">EjercicioPE102/<wbr/>Cut</a></li><li class=" tsd-kind-module"><a href="modules/ejercicio_2_WordFinder.html">ejercicio-<wbr/>2/<wbr/>Word<wbr/>Finder</a></li><li class=" tsd-kind-module"><a href="modules/ejercicio_3_DirectoryWatcher.html">ejercicio-<wbr/>3/<wbr/>Directory<wbr/>Watcher</a></li><li class=" tsd-kind-module"><a href="modules/ejercicio_4_Wrapper.html">ejercicio-<wbr/>4/<wbr/>Wrapper</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>